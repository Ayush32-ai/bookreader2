{"version":3,"file":"plugins/plugin.text_selection.js","mappings":"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","sources":["webpack://@internetarchive/bookreader/./src/BookReader/utils/SelectionObserver.js","webpack://@internetarchive/bookreader/./src/util/strings.js","webpack://@internetarchive/bookreader/./src/plugins/plugin.text_selection.js","webpack://@internetarchive/bookreader/./node_modules/core-js/internals/string-trim-forced.js","webpack://@internetarchive/bookreader/./node_modules/core-js/modules/es.string.trim.js"],"sourcesContent":["// @ts-check\nexport class SelectionObserver {\n  selecting = false;\n  startedInSelector = false;\n  /** @type {HTMLElement} */\n  target = null;\n\n  /**\n   * @param {string} selector\n   * @param {function('started' | 'cleared', HTMLElement): any} handler\n   */\n  constructor(selector, handler) {\n    this.selector = selector;\n    this.handler = handler;\n  }\n\n  attach() {\n    // We can't just use selectstart, because safari on iOS just\n    // randomly decides when to fire it 😤\n    // document.addEventListener(\"selectstart\", this._onSelectStart);\n    // This has to be on document :/\n    document.addEventListener(\"selectionchange\", this._onSelectionChange);\n  }\n\n  detach() {\n    document.removeEventListener(\"selectionchange\", this._onSelectionChange);\n  }\n\n  _onSelectionChange = () => {\n    const sel = window.getSelection();\n\n    if (!this.selecting && sel.toString()) {\n      const target = $(sel.anchorNode).closest(this.selector)[0];\n      if (!target) return;\n      this.target = target;\n      this.selecting = true;\n      this.handler('started', this.target);\n    }\n\n    if (this.selecting && (sel.isCollapsed || !sel.toString() || !$(sel.anchorNode).closest(this.selector)[0])) {\n      this.selecting = false;\n      this.handler('cleared', this.target);\n    }\n  };\n}\n","/**\n * @typedef {String} StringWithVars\n * A template string with {{foo}} style variables\n * Also supports filters, like {{bookPath|urlencode}} (See APPLY_FILTERS for the\n * supported list of filters)\n **/\n\n/**\n * @param {StringWithVars|String} template\n * @param { {[varName: string]: { toString: () => string} } } vars\n * @param { {[varName: string]: { toString: () => string} } } [overrides]\n */\nexport function applyVariables(template, vars, overrides = {}, possibleFilters = APPLY_FILTERS) {\n  return template?.replace(/\\{\\{([^}]*?)\\}\\}/g, ($0, $1) => {\n    if (!$1) return $0;\n    /** @type {string} */\n    const expression = $1;\n    const [varName, ...filterNames] = expression.split('|').map(x => x.trim());\n    const defined = varName in overrides || varName in vars;\n\n    // If it's not defined, don't expand it at all\n    if (!defined) return $0;\n\n    const value = varName in overrides ? overrides[varName]\n      : varName in vars ? vars[varName] : null;\n    const filters = filterNames.map(n => possibleFilters[n]);\n    return filters.reduce((acc, cur) => cur(acc), value && value.toString());\n  });\n}\n\n/** @type { {[filterName: String]:( string => string)} } */\nexport const APPLY_FILTERS = {\n  urlencode: encodeURIComponent,\n};\n","//@ts-check\nimport { createDIVPageLayer } from '../BookReader/PageContainer.js';\nimport { SelectionObserver } from '../BookReader/utils/SelectionObserver.js';\nimport { applyVariables } from '../util/strings.js';\n/** @typedef {import('../util/strings.js').StringWithVars} StringWithVars */\n/** @typedef {import('../BookReader/PageContainer.js').PageContainer} PageContainer */\n\nconst BookReader = /** @type {typeof import('../BookReader').default} */(window.BookReader);\n\nexport const DEFAULT_OPTIONS = {\n  enabled: true,\n  /** @type {StringWithVars} The URL to fetch the entire DJVU xml. Supports options.vars */\n  fullDjvuXmlUrl: null,\n  /** @type {StringWithVars} The URL to fetch a single page of the DJVU xml. Supports options.vars. Also has {{pageIndex}} */\n  singlePageDjvuXmlUrl: null,\n  /** Whether to fetch the XML as a jsonp */\n  jsonp: false,\n};\n/** @typedef {typeof DEFAULT_OPTIONS} TextSelectionPluginOptions */\n\n/**\n * @template T\n */\nexport class Cache {\n  constructor(maxSize = 10) {\n    this.maxSize = maxSize;\n    /** @type {T[]} */\n    this.entries = [];\n  }\n\n  /**\n   * @param {T} entry\n   */\n  add(entry) {\n    if (this.entries.length >= this.maxSize) {\n      this.entries.shift();\n    }\n    this.entries.push(entry);\n  }\n}\n\nexport class TextSelectionPlugin {\n  /**\n   * @param {'lr' | 'rl'} pageProgression In the future this should be in the ocr file\n   * since a book being right to left doesn't mean the ocr is right to left. But for\n   * now we do make that assumption.\n   */\n  constructor(options = DEFAULT_OPTIONS, optionVariables, pageProgression = 'lr') {\n    this.options = options;\n    this.optionVariables = optionVariables;\n    /**@type {PromiseLike<JQuery<HTMLElement>|undefined>} */\n    this.djvuPagesPromise = null;\n    /** Whether the book is right-to-left */\n    this.rtl = pageProgression === 'rl';\n\n    /** @type {Cache<{index: number, response: any}>} */\n    this.pageTextCache = new Cache();\n\n    /**\n     * Sometimes there are too many words on a page, and the browser becomes near\n     * unusable. For now don't render text layer for pages with too many words.\n     */\n    this.maxWordRendered = 2500;\n\n    this.selectionObserver = new SelectionObserver('.BRtextLayer', this._onSelectionChange);\n  }\n\n  /**\n   * @param {'started' | 'cleared'} type\n   * @param {HTMLElement} target\n   */\n  _onSelectionChange = (type, target) => {\n    if (type === 'started') {\n      this.textSelectingMode(target);\n    } else if (type === 'cleared') {\n      this.defaultMode(target);\n    } else {\n      throw new Error(`Unknown type ${type}`);\n    }\n  }\n\n  init() {\n    this.selectionObserver.attach();\n\n    // Only fetch the full djvu xml if the single page url isn't there\n    if (this.options.singlePageDjvuXmlUrl) return;\n    this.djvuPagesPromise = $.ajax({\n      type: \"GET\",\n      url: applyVariables(this.options.fullDjvuXmlUrl, this.optionVariables),\n      dataType: this.options.jsonp ? \"jsonp\" : \"html\",\n      cache: true,\n      error: (e) => undefined\n    }).then((res) => {\n      try {\n        const xmlMap = $.parseXML(res);\n        return xmlMap && $(xmlMap).find(\"OBJECT\");\n      } catch (e) {\n        return undefined;\n      }\n    });\n  }\n\n  /**\n   * @param {number} index\n   * @returns {Promise<HTMLElement|undefined>}\n   */\n  async getPageText(index) {\n    if (this.options.singlePageDjvuXmlUrl) {\n      const cachedEntry = this.pageTextCache.entries.find(x => x.index == index);\n      if (cachedEntry) {\n        return cachedEntry.response;\n      }\n      const res = await $.ajax({\n        type: \"GET\",\n        url: applyVariables(this.options.singlePageDjvuXmlUrl, this.optionVariables, { pageIndex: index }),\n        dataType: this.options.jsonp ? \"jsonp\" : \"html\",\n        cache: true,\n        error: (e) => undefined,\n      });\n      try {\n        const xmlDoc = $.parseXML(res);\n        const result = xmlDoc && $(xmlDoc).find(\"OBJECT\")[0];\n        this.pageTextCache.add({ index, response: result });\n        return result;\n      } catch (e) {\n        return undefined;\n      }\n    } else {\n      const XMLpagesArr = await this.djvuPagesPromise;\n      if (XMLpagesArr) return XMLpagesArr[index];\n    }\n  }\n\n  /**\n   * Intercept copied text to remove any styling applied to it\n   * @param {JQuery} $container\n   */\n  interceptCopy($container) {\n    $container[0].addEventListener('copy', (event) => {\n      const selection = document.getSelection();\n      event.clipboardData.setData('text/plain', selection.toString());\n      event.preventDefault();\n    });\n  }\n\n  /**\n   * Applies mouse events when in default mode\n   * @param {HTMLElement} textLayer\n   */\n  defaultMode(textLayer) {\n    const $pageContainer = $(textLayer).closest('.BRpagecontainer');\n    textLayer.style.pointerEvents = \"none\";\n    $pageContainer.find(\"img\").css(\"pointer-events\", \"auto\");\n\n    $(textLayer).off(\".textSelectPluginHandler\");\n    const startedMouseDown = this.mouseIsDown;\n    let skipNextMouseup = this.mouseIsDown;\n    if (startedMouseDown) {\n      textLayer.style.pointerEvents = \"auto\";\n    }\n\n    // Need to stop propagation to prevent DragScrollable from\n    // blocking selection\n    $(textLayer).on(\"mousedown.textSelectPluginHandler\", (event) => {\n      this.mouseIsDown = true;\n      if ($(event.target).is(\".BRwordElement, .BRspace\")) {\n        event.stopPropagation();\n      }\n    });\n\n    $(textLayer).on(\"mouseup.textSelectPluginHandler\", (event) => {\n      this.mouseIsDown = false;\n      textLayer.style.pointerEvents = \"none\";\n      if (skipNextMouseup) {\n        skipNextMouseup = false;\n        event.stopPropagation();\n      }\n    });\n  }\n\n  /**\n   * This mode is active while there is a selection on the given textLayer\n   * @param {HTMLElement} textLayer\n   */\n  textSelectingMode(textLayer) {\n    const $pageContainer = $(textLayer).closest('.BRpagecontainer');\n    // Make text layer consume all events\n    textLayer.style.pointerEvents = \"all\";\n    // Block img from getting long-press to save while selecting\n    $pageContainer.find(\"img\").css(\"pointer-events\", \"none\");\n\n    $(textLayer).off(\".textSelectPluginHandler\");\n\n    $(textLayer).on('mousedown.textSelectPluginHandler', (event) => {\n      this.mouseIsDown = true;\n      event.stopPropagation();\n    });\n\n    // Prevent page flip on click\n    $(textLayer).on('mouseup.textSelectPluginHandler', (event) => {\n      this.mouseIsDown = false;\n      event.stopPropagation();\n    });\n  }\n\n  /**\n   * Initializes text selection modes if there is a text layer on the page\n   * @param {JQuery} $container\n   */\n  stopPageFlip($container) {\n    /** @type {JQuery<HTMLElement>} */\n    const $textLayer = $container.find('.BRtextLayer');\n    if (!$textLayer.length) return;\n    $textLayer.each((i, s) => this.defaultMode(s));\n    this.interceptCopy($container);\n  }\n\n  /**\n   * @param {PageContainer} pageContainer\n   */\n  async createTextLayer(pageContainer) {\n    const pageIndex = pageContainer.page.index;\n    const $container = pageContainer.$container;\n    const $textLayers = $container.find('.BRtextLayer');\n    if ($textLayers.length) return;\n    const XMLpage = await this.getPageText(pageIndex);\n    if (!XMLpage) return;\n    recursivelyAddCoords(XMLpage);\n\n    const totalWords = $(XMLpage).find(\"WORD\").length;\n    if (totalWords > this.maxWordRendered) {\n      console.log(`Page ${pageIndex} has too many words (${totalWords} > ${this.maxWordRendered}). Not rendering text layer.`);\n      return;\n    }\n\n    const textLayer = createDIVPageLayer(pageContainer.page, 'BRtextLayer');\n    const ratioW = parseFloat(pageContainer.$container[0].style.width) / pageContainer.page.width;\n    const ratioH = parseFloat(pageContainer.$container[0].style.height) / pageContainer.page.height;\n    textLayer.style.transform = `scale(${ratioW}, ${ratioH})`;\n    textLayer.setAttribute(\"dir\", this.rtl ? \"rtl\" : \"ltr\");\n\n    const ocrParagraphs = $(XMLpage).find(\"PARAGRAPH[coords]\").toArray();\n    const paragEls = ocrParagraphs.map(p => {\n      const el = this.renderParagraph(p);\n      textLayer.appendChild(el);\n      return el;\n    });\n\n    // Fix up paragraph positions\n    const paragraphRects = determineRealRects(textLayer, '.BRparagraphElement');\n    let yAdded = 0;\n    for (const [ocrParagraph, paragEl] of zip(ocrParagraphs, paragEls)) {\n      const ocrParagBounds = $(ocrParagraph).attr(\"coords\").split(\",\").map(parseFloat);\n      const realRect = paragraphRects.get(paragEl);\n      const [ocrLeft, , ocrRight, ocrTop] = ocrParagBounds;\n      const newStartMargin = this.rtl ? (realRect.right - ocrRight) : (ocrLeft - realRect.left);\n      const newTop = ocrTop - (realRect.top + yAdded);\n\n      paragEl.style[this.rtl ? 'marginRight' : 'marginLeft'] = `${newStartMargin}px`;\n      paragEl.style.marginTop = `${newTop}px`;\n      yAdded += newTop;\n      textLayer.appendChild(paragEl);\n    }\n    $container.append(textLayer);\n    this.stopPageFlip($container);\n  }\n\n  /**\n   * @param {HTMLElement} ocrParagraph\n   * @returns {HTMLParagraphElement}\n   */\n  renderParagraph(ocrParagraph) {\n    const paragEl = document.createElement('p');\n    paragEl.classList.add('BRparagraphElement');\n    const [paragLeft, paragBottom, paragRight, paragTop] = $(ocrParagraph).attr(\"coords\").split(\",\").map(parseFloat);\n    const wordHeightArr = [];\n    const lines = $(ocrParagraph).find(\"LINE[coords]\").toArray();\n    if (!lines.length) return paragEl;\n\n\n    for (const [prevLine, line, nextLine] of lookAroundWindow(genMap(lines, augmentLine))) {\n      const isLastLineOfParagraph = line.ocrElement == lines[lines.length - 1];\n      const lineEl = document.createElement('span');\n      lineEl.classList.add('BRlineElement');\n\n      for (const [wordIndex, currWord] of line.words.entries()) {\n        const [, bottom, right, top] = $(currWord).attr(\"coords\").split(',').map(parseFloat);\n        const wordHeight = bottom - top;\n        wordHeightArr.push(wordHeight);\n\n        if (wordIndex == 0 && prevLine?.lastWord.textContent.trim().endsWith('-')) {\n          // ideally prefer the next line to determine the left position,\n          // since the previous line could be the first line of the paragraph\n          // and hence have an incorrectly indented first word.\n          // E.g. https://archive.org/details/driitaleofdaring00bachuoft/page/360/mode/2up\n          const [newLeft, , , ] = $((nextLine || prevLine).firstWord).attr(\"coords\").split(',').map(parseFloat);\n          $(currWord).attr(\"coords\", `${newLeft},${bottom},${right},${top}`);\n        }\n\n        const wordEl = document.createElement('span');\n        wordEl.setAttribute(\"class\", \"BRwordElement\");\n        wordEl.textContent = currWord.textContent.trim();\n\n        if (wordIndex > 0) {\n          const space = document.createElement('span');\n          space.classList.add('BRspace');\n          space.textContent = ' ';\n          lineEl.append(space);\n\n          // Edge ignores empty elements (like BRspace), so add another\n          // space to ensure Edge's ReadAloud works correctly.\n          lineEl.appendChild(document.createTextNode(' '));\n        }\n\n        lineEl.appendChild(wordEl);\n      }\n\n      const hasHyphen = line.lastWord.textContent.trim().endsWith('-');\n      const lastWordEl = lineEl.children[lineEl.children.length - 1];\n      if (hasHyphen && !isLastLineOfParagraph) {\n        lastWordEl.textContent = lastWordEl.textContent.trim().slice(0, -1);\n        lastWordEl.classList.add('BRwordElement--hyphen');\n      }\n\n      paragEl.appendChild(lineEl);\n      if (!isLastLineOfParagraph && !hasHyphen) {\n        // Edge does not correctly have spaces between the lines.\n        paragEl.appendChild(document.createTextNode(' '));\n      }\n    }\n\n    wordHeightArr.sort((a, b) => a - b);\n    const paragWordHeight = wordHeightArr[Math.floor(wordHeightArr.length * 0.85)] + 4;\n    paragEl.style.left = `${paragLeft}px`;\n    paragEl.style.top = `${paragTop}px`;\n    paragEl.style.width = `${paragRight - paragLeft}px`;\n    paragEl.style.height = `${paragBottom - paragTop}px`;\n    paragEl.style.fontSize = `${paragWordHeight}px`;\n\n    // Fix up sizes - stretch/crush words as necessary using letter spacing\n    let wordRects = determineRealRects(paragEl, '.BRwordElement');\n    const ocrWords = $(ocrParagraph).find(\"WORD\").toArray();\n    const wordEls = paragEl.querySelectorAll('.BRwordElement');\n    for (const [ocrWord, wordEl] of zip(ocrWords, wordEls)) {\n      const realRect = wordRects.get(wordEl);\n      const [left, , right ] = $(ocrWord).attr(\"coords\").split(',').map(parseFloat);\n      let ocrWidth = right - left;\n      // Some books (eg theworksofplato01platiala) have a space _inside_ the <WORD>\n      // element. That makes it impossible to determine the correct positining\n      // of everything, but to avoid the BRspace's being width 0, which makes selection\n      // janky on Chrome Android, assume the space is the same width as one of the\n      // letters.\n      if (ocrWord.textContent.endsWith(' ')) {\n        ocrWidth = ocrWidth * (ocrWord.textContent.length - 1) / ocrWord.textContent.length;\n      }\n      const diff = ocrWidth - realRect.width;\n      wordEl.style.letterSpacing = `${diff / (ocrWord.textContent.length - 1)}px`;\n    }\n\n    // Stretch/crush lines as necessary using line spacing\n    // Recompute rects after letter spacing\n    wordRects = determineRealRects(paragEl, '.BRwordElement');\n    const spaceRects = determineRealRects(paragEl, '.BRspace');\n\n    const ocrLines = $(ocrParagraph).find(\"LINE[coords]\").toArray();\n    const lineEls = Array.from(paragEl.querySelectorAll('.BRlineElement'));\n\n    let ySoFar = paragTop;\n    for (const [ocrLine, lineEl] of zip(ocrLines, lineEls)) {\n      // shift words using marginLeft to align with the correct x position\n      const words = $(ocrLine).find(\"WORD\").toArray();\n      // const ocrLineLeft = Math.min(...words.map(w => parseFloat($(w).attr(\"coords\").split(',')[0])));\n      let xSoFar = this.rtl ? paragRight : paragLeft;\n      for (const [ocrWord, wordEl] of zip(words, lineEl.querySelectorAll('.BRwordElement'))) {\n        // start of line, need to compute the offset relative to the OCR words\n        const wordRect = wordRects.get(wordEl);\n        const [ocrLeft, , ocrRight ] = $(ocrWord).attr(\"coords\").split(',').map(parseFloat);\n        const diff = (this.rtl ? -(ocrRight - xSoFar) : ocrLeft - xSoFar);\n\n        if (wordEl.previousElementSibling) {\n          const space = wordEl.previousElementSibling;\n          space.style.letterSpacing = `${diff - spaceRects.get(space).width}px`;\n        } else {\n          wordEl.style[this.rtl ? 'paddingRight' : 'paddingLeft'] = `${diff}px`;\n        }\n        if (this.rtl) xSoFar -= diff + wordRect.width;\n        else xSoFar += diff + wordRect.width;\n      }\n      // And also fix y position\n      const ocrLineTop = Math.min(...words.map(w => parseFloat($(w).attr(\"coords\").split(',')[3])));\n      const diff = ocrLineTop - ySoFar;\n      if (lineEl.previousElementSibling) {\n        lineEl.previousElementSibling.style.lineHeight = `${diff}px`;\n        ySoFar += diff;\n      }\n    }\n\n    // The last line will have a line height subtracting from the paragraph height\n    lineEls[lineEls.length - 1].style.lineHeight = `${paragBottom - ySoFar}px`;\n\n    // Edge does not include a newline for some reason when copying/pasting the <p> els\n    paragEl.appendChild(document.createElement('br'));\n    return paragEl;\n  }\n}\n\nexport class BookreaderWithTextSelection extends BookReader {\n  init() {\n    const options = Object.assign({}, DEFAULT_OPTIONS, this.options.plugins.textSelection);\n    if (options.enabled) {\n      this.textSelectionPlugin = new TextSelectionPlugin(options, this.options.vars, this.pageProgression);\n      // Write this back; this way the plugin is the source of truth, and BR just\n      // contains a reference to it.\n      this.options.plugins.textSelection = options;\n      this.textSelectionPlugin.init();\n\n      new SelectionObserver('.BRtextLayer', (selectEvent) => {\n        // Track how often selection is used\n        if (selectEvent == 'started') {\n          this.archiveAnalyticsSendEvent?.('BookReader', 'SelectStart');\n\n          // Set a class on the page to avoid hiding it when zooming/etc\n          this.refs.$br.find('.BRpagecontainer--hasSelection').removeClass('BRpagecontainer--hasSelection');\n          $(window.getSelection().anchorNode).closest('.BRpagecontainer').addClass('BRpagecontainer--hasSelection');\n        }\n      }).attach();\n    }\n\n    super.init();\n  }\n\n  /**\n   * @param {number} index\n   */\n  _createPageContainer(index) {\n    const pageContainer = super._createPageContainer(index);\n    // Disable if thumb mode; it's too janky\n    // .page can be null for \"pre-cover\" region\n    if (this.mode !== this.constModeThumb && pageContainer.page) {\n      this.textSelectionPlugin?.createTextLayer(pageContainer);\n    }\n    return pageContainer;\n  }\n}\nwindow.BookReader = BookreaderWithTextSelection;\nexport default BookreaderWithTextSelection;\n\n\n/**\n * @param {HTMLElement} parentEl\n * @param {string} selector\n * @returns {Map<Element, Rect>}\n */\nfunction determineRealRects(parentEl, selector) {\n  const initals = {\n    position: parentEl.style.position,\n    visibility: parentEl.style.visibility,\n    top: parentEl.style.top,\n    left: parentEl.style.left,\n    transform: parentEl.style.transform,\n  };\n  parentEl.style.position = 'absolute';\n  parentEl.style.visibility = 'hidden';\n  parentEl.style.top = '0';\n  parentEl.style.left = '0';\n  parentEl.style.transform = 'none';\n  document.body.appendChild(parentEl);\n  const rects = new Map(\n    Array.from(parentEl.querySelectorAll(selector))\n      .map(wordEl => {\n        const origRect = wordEl.getBoundingClientRect();\n        return [wordEl, new Rect(\n          origRect.left + window.scrollX,\n          origRect.top + window.scrollY,\n          origRect.width,\n          origRect.height,\n        )];\n      })\n  );\n  document.body.removeChild(parentEl);\n  Object.assign(parentEl.style, initals);\n  return rects;\n}\n\n/**\n * @param {HTMLElement} line\n */\nfunction augmentLine(line) {\n  const words = $(line).find(\"WORD\").toArray();\n  return {\n    ocrElement: line,\n    words,\n    firstWord: words[0],\n    lastWord: words[words.length - 1],\n  };\n}\n\n/**\n * @template TFrom, TTo\n * Generator version of map\n * @param {Iterable<TFrom>} gen\n * @param {function(TFrom): TTo} fn\n * @returns {Iterable<TTo>}\n */\nexport function* genMap(gen, fn) {\n  for (const x of gen) yield fn(x);\n}\n\n/**\n * @template T\n * Generator that provides a sliding window of 3 elements,\n * prev, current, and next.\n * @param {Iterable<T>} gen\n * @returns {Iterable<[T | undefined, T, T | undefined]>}\n */\nexport function* lookAroundWindow(gen) {\n  let prev = undefined;\n  let cur = undefined;\n  let next = undefined;\n  for (const x of gen) {\n    if (typeof cur !== 'undefined') {\n      next = x;\n      yield [prev, cur, next];\n    }\n    prev = cur;\n    cur = x;\n    next = undefined;\n  }\n\n  if (typeof cur !== 'undefined') {\n    yield [prev, cur, next];\n  }\n}\n\n/**\n * @template T1, T2\n * Lazy zip implementation to avoid importing lodash\n * Expects iterators to be of the same length\n * @param {Iterable<T1>} gen1\n * @param {Iterable<T2>} gen2\n * @returns {Iterable<[T1, T2]>}\n */\nexport function* zip(gen1, gen2) {\n  const it1 = gen1[Symbol.iterator]();\n  const it2 = gen2[Symbol.iterator]();\n  while (true) {\n    const r1 = it1.next();\n    const r2 = it2.next();\n    if (r1.done && r2.done) {\n      return;\n    }\n    if (r1.done || r2.done) {\n      throw new Error('zip: one of the iterators is done');\n    }\n    yield [r1.value, r2.value];\n  }\n}\n\n/**\n * [left, bottom, right, top]\n * @param {Array<[number, number, number, number]>} bounds\n * @returns {[number, number, number, number]}\n */\nfunction determineBounds(bounds) {\n  let leftMost = Infinity;\n  let bottomMost = -Infinity;\n  let rightMost = -Infinity;\n  let topMost = Infinity;\n\n  for (const [left, bottom, right, top] of bounds) {\n    leftMost = Math.min(leftMost, left);\n    bottomMost = Math.max(bottomMost, bottom);\n    rightMost = Math.max(rightMost, right);\n    topMost = Math.min(topMost, top);\n  }\n\n  return [leftMost, bottomMost, rightMost, topMost];\n}\n\n/**\n * Recursively traverses the XML tree and adds coords\n * which are the bounding box of all child coords\n * @param {Element} xmlEl\n */\nfunction recursivelyAddCoords(xmlEl) {\n  if ($(xmlEl).attr('coords') || !xmlEl.children) {\n    return;\n  }\n\n  const children = $(xmlEl).children().toArray();\n  if (children.length === 0) {\n    return;\n  }\n\n  for (const child of children) {\n    recursivelyAddCoords(child);\n  }\n\n  const childCoords = [];\n\n  for (const child of children) {\n    if (!$(child).attr('coords')) continue;\n    childCoords.push($(child).attr('coords').split(',').map(parseFloat));\n  }\n\n  const boundingCoords = determineBounds(childCoords);\n  if (Math.abs(boundingCoords[0]) != Infinity) {\n    $(xmlEl).attr('coords', boundingCoords.join(','));\n  }\n}\n\n/**\n * Basically a polyfill for the native DOMRect class\n */\nclass Rect {\n  /**\n   * @param {number} x\n   * @param {number} y\n   * @param {number} width\n   * @param {number} height\n   */\n  constructor(x, y, width, height) {\n    this.x = x;\n    this.y = y;\n    this.width = width;\n    this.height = height;\n  }\n\n  get right() { return this.x + this.width; }\n  get bottom() { return this.y + this.height; }\n  get top() { return this.y; }\n  get left() { return this.x; }\n}\n","'use strict';\nvar PROPER_FUNCTION_NAME = require('../internals/function-name').PROPER;\nvar fails = require('../internals/fails');\nvar whitespaces = require('../internals/whitespaces');\n\nvar non = '\\u200B\\u0085\\u180E';\n\n// check that a method works with the correct list\n// of whitespaces and has a correct name\nmodule.exports = function (METHOD_NAME) {\n  return fails(function () {\n    return !!whitespaces[METHOD_NAME]()\n      || non[METHOD_NAME]() !== non\n      || (PROPER_FUNCTION_NAME && whitespaces[METHOD_NAME].name !== METHOD_NAME);\n  });\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar $trim = require('../internals/string-trim').trim;\nvar forcedStringTrimMethod = require('../internals/string-trim-forced');\n\n// `String.prototype.trim` method\n// https://tc39.es/ecma262/#sec-string.prototype.trim\n$({ target: 'String', proto: true, forced: forcedStringTrimMethod('trim') }, {\n  trim: function trim() {\n    return $trim(this);\n  }\n});\n"],"names":["SelectionObserver","selector","handler","_this","_classCallCheck","_defineProperty","sel","window","getSelection","selecting","toString","target","$","anchorNode","closest","isCollapsed","this","key","value","document","addEventListener","_onSelectionChange","removeEventListener","applyVariables","template","vars","overrides","arguments","length","undefined","possibleFilters","APPLY_FILTERS","replace","$0","$1","_expression$split$map2","split","map","x","trim","varName","filterNames","slice","n","reduce","acc","cur","urlencode","encodeURIComponent","genMap","_marked2","_regeneratorRuntime","mark","lookAroundWindow","_marked3","zip","_callSuper","t","o","e","_getPrototypeOf","_typeof","TypeError","ReferenceError","_assertThisInitialized","_possibleConstructorReturn","_isNativeReflectConstruct","Reflect","construct","constructor","apply","Boolean","prototype","valueOf","call","_get","get","bind","r","p","hasOwnProperty","_superPropBase","Object","getOwnPropertyDescriptor","setPrototypeOf","getPrototypeOf","__proto__","_setPrototypeOf","_slicedToArray","Array","isArray","_arrayWithHoles","l","Symbol","iterator","i","u","a","f","next","done","push","return","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","_createForOfIteratorHelper","_n","F","s","_arrayLikeToArray","name","from","test","defineProperty","c","asyncIterator","toStringTag","define","enumerable","configurable","writable","wrap","Generator","create","Context","makeInvokeMethod","tryCatch","type","arg","h","y","GeneratorFunction","GeneratorFunctionPrototype","d","v","values","g","defineIteratorMethods","forEach","_invoke","AsyncIterator","invoke","resolve","__await","then","callInvokeWithMethodAndArg","Error","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","resultName","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","isNaN","displayName","isGeneratorFunction","awrap","async","Promise","keys","reverse","pop","prev","charAt","stop","rval","handle","complete","finish","catch","delegateYield","asyncGeneratorStep","_asyncToGenerator","_next","_throw","_defineProperties","_toPropertyKey","_createClass","toPrimitive","String","_toPrimitive","BookReader","DEFAULT_OPTIONS","enabled","fullDjvuXmlUrl","singlePageDjvuXmlUrl","jsonp","Cache","maxSize","entries","entry","shift","TextSelectionPlugin","options","optionVariables","pageProgression","textSelectingMode","concat","defaultMode","djvuPagesPromise","rtl","pageTextCache","maxWordRendered","selectionObserver","attach","ajax","url","dataType","cache","error","res","xmlMap","parseXML","find","_getPageText","_callee","index","cachedEntry","xmlDoc","result","XMLpagesArr","_context","response","pageIndex","add","t0","_x","$container","event","selection","clipboardData","setData","preventDefault","textLayer","_this2","$pageContainer","style","pointerEvents","css","off","startedMouseDown","mouseIsDown","skipNextMouseup","on","is","stopPropagation","_this3","_this4","$textLayer","each","interceptCopy","_createTextLayer","_callee2","pageContainer","XMLpage","totalWords","ratioW","ratioH","ocrParagraphs","paragEls","paragraphRects","yAdded","_iterator","_step","_step$value","ocrParagraph","paragEl","ocrParagBounds","realRect","_ocrParagBounds","ocrLeft","ocrRight","ocrTop","newStartMargin","newTop","_this5","_context2","page","getPageText","recursivelyAddCoords","console","log","createDIVPageLayer","parseFloat","width","height","transform","setAttribute","toArray","el","renderParagraph","appendChild","determineRealRects","attr","right","left","top","marginTop","err","append","stopPageFlip","_x2","createElement","classList","_$$attr$split$map2","paragLeft","paragBottom","paragRight","paragTop","wordHeightArr","lines","_step2","_iterator2","augmentLine","_step2$value","prevLine","line","nextLine","isLastLineOfParagraph","ocrElement","lineEl","_step5","_iterator5","words","_step5$value","wordIndex","currWord","_$$attr$split$map4","bottom","wordHeight","lastWord","textContent","endsWith","newLeft","firstWord","wordEl","space","createTextNode","hasHyphen","lastWordEl","children","sort","b","paragWordHeight","Math","floor","fontSize","_step3","wordRects","_iterator3","querySelectorAll","_step3$value","ocrWord","_$$attr$split$map8","ocrWidth","diff","letterSpacing","_step4","spaceRects","ocrLines","lineEls","ySoFar","_iterator4","_step6","_step4$value","ocrLine","xSoFar","_iterator6","_step6$value","wordRect","_$$attr$split$map10","previousElementSibling","min","_arrayWithoutHoles","w","_iterableToArray","_nonIterableSpread","lineHeight","BookreaderWithTextSelection","_BookReader","_inherits","_this6","assign","plugins","textSelection","textSelectionPlugin","init","selectEvent","_this6$archiveAnalyti","archiveAnalyticsSendEvent","refs","$br","removeClass","addClass","_this$textSelectionPl","mode","constModeThumb","createTextLayer","parentEl","initals","position","visibility","body","rects","Map","origRect","getBoundingClientRect","Rect","scrollX","scrollY","removeChild","gen","fn","_iterator7","_step7","_context3","_marked","_iterator8","_step8","_context4","gen1","gen2","it1","it2","r1","r2","_context5","xmlEl","_step10","_iterator10","_step11","childCoords","_iterator11","child","boundingCoords","bounds","_step9","leftMost","Infinity","bottomMost","rightMost","topMost","_iterator9","_step9$value","max","determineBounds","abs","join","PROPER_FUNCTION_NAME","fails","whitespaces","module","exports","METHOD_NAME","$trim","proto","forced","forcedStringTrimMethod"],"sourceRoot":""}